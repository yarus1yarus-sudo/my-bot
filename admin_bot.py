import requests
import json
import os
import random

def load_config():
    try:
        with open('config.json', 'r', encoding='utf-8') as f:
            return json.load(f)
    except:
        return {'bot_enabled': True, 'schedule': 'daily'}

# –ö–õ–Æ–ß–ï–í–ê–Ø –ü–†–û–í–ï–†–ö–ê –í –°–ê–ú–û–ú –ù–ê–ß–ê–õ–ï
config = load_config()
if not config.get('bot_enabled', False):
    print("üõë –ë–æ—Ç –æ—Ç–∫–ª—é—á–µ–Ω —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å. –í—ã—Ö–æ–¥.")
    exit()

print("‚úÖ –ë–æ—Ç –≤–∫–ª—é—á–µ–Ω, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–Ω–µ–∫–¥–æ—Ç...")

TOKEN = os.environ.get('TELEGRAM_BOT_TOKEN')
USER_ID = "6396018806"

def get_joke():
    jokes = [
        "–ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç —Ç—ë–º–Ω—É—é —Ç–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ —Å–≤–µ—Ç –ø—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç –±–∞–≥–∏! üêõ",
        "‚Äî –î–æ–∫—Ç–æ—Ä, —É –º–µ–Ω—è –ø–∞–º—è—Ç—å –∫–∞–∫ —É —Ä—ã–±–∫–∏! ‚Äî –ê —Å –∫–∞–∫–∏—Ö –ø–æ—Ä? ‚Äî –ö—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç? üê†", 
        "–ñ–µ–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—É: ‚Äî –î–æ—Ä–æ–≥–æ–π, —Å—Ö–æ–¥–∏ –≤ –º–∞–≥–∞–∑–∏–Ω –∑–∞ —Ö–ª–µ–±–æ–º, –∏ –µ—Å–ª–∏ –±—É–¥—É—Ç —è–π—Ü–∞ ‚Äî –∫—É–ø–∏ –¥—é–∂–∏–Ω—É. –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç 12 –±–∞—Ç–æ–Ω–æ–≤ —Ö–ª–µ–±–∞. ü•ñ",
        "‚Äî –ü–æ—á–µ–º—É —É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤ –Ω–µ—Ç –¥–µ–≤—É—à–µ–∫? ‚Äî –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –¥—É–º–∞—é—Ç, —á—Ç–æ 1 + 1 = 10! üíª",
        "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç –¥–æ–º–æ–π –≤ 3 —É—Ç—Ä–∞. –ñ–µ–Ω–∞: ‚Äî –¢—ã –≥–¥–µ –±—ã–ª?! ‚Äî –ù–∞ —Ä–∞–±–æ—Ç–µ, –æ—Ç–ª–∞–∂–∏–≤–∞–ª –±–∞–≥–∏. ‚Äî –ê —è —á—Ç–æ, –¥—É—Ä–∞? ‚Äî –ù–µ—Ç, —Ç—ã feature! ‚ú®"
    ]
    return random.choice(jokes)

def send_message(text):
    url = f"https://api.telegram.org/bot{TOKEN}/sendMessage"
    data = {'chat_id': USER_ID, 'text': text, 'parse_mode': 'HTML'}
    
    try:
        response = requests.post(url, data=data, timeout=10)
        return response.status_code == 200
    except:
        return False

if __name__ == "__main__":
    joke = get_joke()
    if send_message(f"üòÑ <b>–ê–Ω–µ–∫–¥–æ—Ç:</b>\n\n{joke}"):
        print("‚úÖ –ê–Ω–µ–∫–¥–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!")
    else:
        print("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏!")
